# 9. 管理（仅管理员） {#9}

金山私有云上的资源（主机、存储、路由、网络等）是以项目为单位进行管理的。

对每一个项目，可以添加多个用户，项目中的用户可以共享项目内的所有资源。但不同角色的用户拥有的权限不同，在此重复一下上文提到的角色权限说明： 

| 角色名称 | 角色说明 |
| :--- | | :--- | 
| Admin | 云平台的超级管理员，拥有全部权限。建议开放给少数人使用。|
| Serviceadmin | 云平台的业务管理员，负责管理云资源、云租户、计费、审批等。|
| Maintenanceadmin | 云平台的运维管理员，负责管理云平台软件、底层物理硬件以及资源的上下线。 |
| 项目 Owner | 租户管理员，拥有一个项目内的所有权限，包括创建虚拟网络、云主机、云硬盘。拥有审批权限。 |
| 项目 Member | 租户成员，权限受限，不能够创建虚拟网络，只能够使用弹性IP、创建云主机和云硬盘。 |

## 9.1 用户管理 {#9-1}

### 9.1.1 查看用户 {#9-1-1}

管理员Admin登录控制台后，选择左侧导航栏“管理->用户管理”，可查看云平台上所有项目的所有用户，用户信息包括：用户名、手机、电子邮件、启用、角色、项目和描述。

* 用户名：用户登录金山私有云时使用的名字。
* 手机：用户的手机号码。
* 电子邮件：用户的邮件地址，格式为name@mail.com.
* 启用：表示该用户当前是否可以登录系统，“是”表示可以。
* 角色：表示该用户所拥有的权限，admin、serviceadmin、maintenanceadmin、owner、member。
* 项目：用户所属的项目组。
* 描述：描述信息，用于说明或备注。

此外，可根据用户名、邮箱、手机号和所属项目对用户进行精确搜索。

### 9.1.2 创建用户 {#9-1-2}

点击用户管理列表右上角的“创建用户”按钮，在弹出的输入框中填写用户名、密码、描述、手机号码、电子邮件，并且选择用户所属的项目和拥有的权限（owner或member），最后点击“创建”完成用户添加。

![](/assets/创建用户.png)

### 9.1.3 更多操作 {#9-1-3}

“更多操作”下拉框位于用户管理列表的右上角，提供的操作有：更新用户、更改密码和删除用户。

| 操作 | 描述 |
| :--- | | :--- |
| 更新用户 | 可修改该用户的用户名、描述、电子邮件、手机号码和启用状态。|
| 更改密码 | 可为该用户设置新密码，注意两次密码输入必须一致。|
| 删除用户 | 弹窗提示是否确定要删除该用户，点击“删除”完成删除操作。|

## 9.2 项目管理 {#9-2}

### 9.2.1 查看项目 {#9-2-1}

管理员可登录控制台查看云平台上所有的项目：

1. 登录控制台，点击左侧导航栏“管理->项目管理”，即可查看私有云上所有的项目，项目列表中显示项目的名称、启用、项目标识和资源池。

  * 名称：项目的名字，由管理员创建时填写。
  * 启用：表示该项目当前是否启用，项目状态为“未启用”时，此项目组中的所有用户均无法登录系统、项目组中的所有资源均无法访问。
  * 项目标识：项目的唯一标识号。
  * 资源池：项目绑定的资源池名称，一个项目至少要与一个资源池绑定。
  
2. 点击项目名称，可查看该项目的详细信息，包括：项目描述、项目成员和配额管理。
   
   * 项目概述：显示该项目的名称、项目标识、状态及资源池信息，并且可以在此进行“绑定资源池”和“解绑资源池”操作。
   
    ![](/assets/项目管理-项目概述.png)

   * 项目成员：显示该项目组下的用户列表，包括用户名称和用户角色。
   
    ![](/assets/项目管理-项目成员.png)
    
    选中某个成员，可为该用户重新分配角色，可选的用户角色有两种，owner和member。
    
    ![](/assets/项目管理-分配角色.png)
    
   * 配额管理：显示该项目组的资源使用情况，资源类型包括计算资源、网络资源、安全组和存储资源，可以在此增加或是减少项目配额（当鼠标悬浮至具体的资源条目上时，该资源配额后方将出现编辑图标，点击即可编辑资源配额）。

    ![](/assets/项目管理-配额管理.png)

### 9.2.2 创建项目 {#9-2-2}

选择左侧导航栏的“管理->项目管理”列表，点击右侧牙面右上角的“创建项目”按钮，弹出创建项目窗口，填写项目名称，选择要绑定的资源池，勾选启用，点击“创建项目”完成创建。

每个项目至少要绑定1个资源池，最多可绑定5个资源池。

![](/assets/项目管理-创建项目.png)

### 9.2.3 更多操作 {#9-2-3}

点击项目管理列表每个项目的右侧都有更多操作，可选择编辑项目、删除项目或绑定解绑资源池操作。

| 操作 | 对应按钮 | 前提条件 | 描述 |
| :--- | | :--- | | :--- | | :--- |
| 编辑名称 | ![](/assets/icon-edit.png) | -- | 修改项目的名称 |
| 删除项目 | ![](/assets/icon-delete.png) | 项目下无已分配的云资源 | 项目下面有绑定的资源池时不允许删除 |
| 绑定资源池 | ![](/assets/icon-more.png) | 项目绑定的资源池数未超过5个 | 每个项目最多能同时绑定5个资源池。 |
| 解绑资源池 | ![](/assets/icon-more.png) | 资源池下面没有分配资源 | 待解绑的资源池下面不能有分配资源，否则解绑失败。 |

## 9.3 存储管理 {#9-3}

金山云私有云集群将底层的存储细节结构化展示给用户，在用户控制台界面实现存储后端的灵活安装、配置、添加及管理。且相关配置不依赖于配置文件，能够实现水平扩展。 存储的安装过程充分自动化，不需要手动操作。（详见4云存储服务）

### 9.3.1 磁盘列表 {#9-3-1}

点击左侧菜单栏的“管理->存储管理”，进入存储管理页面，点击“磁盘列表”选项卡即可查看磁盘列表，列表中展示的信息包括：磁盘盘符、所属物理机、挂载目录、大小、使用率、类型、状态、组ID和存储进程端口。

在此页面可探测出物理机集群的磁盘。探测方式分为“探测集群磁盘”和“探测物理机磁盘”两种。其中“探测集群磁盘”按钮是一次性探测出物理机集群的所有磁盘，“探测物理机磁盘”可选择不同的物理机进行探测。

![](/assets/存储管理-探测磁盘.png)

针对磁盘的操作包括编辑和删除：

| 操作 | 对应按钮 | 前提条件 | 描述 |
| :--- | | :--- | | :--- | | :--- |
| 编辑磁盘 | ![](/assets/icon-edit.png) | 磁盘处于可用状态 | 更改磁盘类型 |
| 删除磁盘 | ![](/assets/icon-delete.png) | 磁盘处于可用状态 | 正在使用状态下的磁盘不可删除 |

### 9.3.2 存储集群 {#9-3-2}

点击左侧菜单栏的“管理->存储管理”，进入存储管理页面，点击“存储集群”选项卡即可查看存储集群列表，列表中展示的信息包括：名称、描述、磁盘数量、网关端口、集群类型、状态、启/禁用状态，及创建时间。

#### 9.3.2.1 创建存储集群 {#9-3-2-1}

点击页面右上方“创建存储集群”按钮，在弹出的输入框中输入名称、描述、选择类型（sata/ssd/sas），最后点击“确定”按钮，创建存储集群。

![](/assets/存储管理-创建存储集群.png)

#### 9.3.2.2 扩展存储集群 {#9-3-2-2}

点击右侧“扩容”，弹出框中会列出探测到的同类型（sata/ssd/sas）磁盘，用户可在左侧下拉列表中勾选，并且在右侧“已选磁盘”中点击删除按钮可移除不想选的磁盘。但是之前已经添加成功的磁盘无法在此删除。

![](/assets/存储管理-扩容.png)

#### 9.3.2.3 启用/禁用集群 {#9-3-2-3}

点击列表右侧的“启用/禁用”功能链接，可启用/禁用存储集群。

启用存储集群时，需选择启用后要上架的卷类型产品:

![](/assets/存储集群-启用-上架产品.png)

禁用存储集群时，如果集群为默认集群，则禁用按钮不可点击。


#### 9.3.2.4 其他操作 {#9-3-2-4}

| 操作 | 对应按钮 | 前提条件 | 描述 |
| :--- | | :--- | | :--- | | :--- |
| 编辑集群 | ![](/assets/icon-edit.png) | 磁盘处于可用状态 | 更改磁盘类型 |
| 删除集群 | ![](/assets/icon-delete.png) | 集群处于启用状态、集群上没有数据且不是默认集群 | 处于禁用状态的集群不可删除，默认集群也不可删除，如果集群上有数据，则删除失败 |
| 设为默认集群 | 设为默认 | -- | 设为默认集群后，该集群不可禁用，也不可删除 |

## 9.4 节点部署管理 {#9-4}

### 9.4.1 背景知识 {#9-4-1}

管理员可通过“节点部署管理”进行KingStack云环境的部署安装。KingStack的节点可分为一下类型：

| 节点类型 | 功能说明 | 安装部署方式 |
| :--- | |:--- | | :--- |
| 控制节点 | 云平台的全部管理组件都部署在控制节点 | 通过自动化脚本安装 |
| 计算节点 | 计算节点用于部署计算虚拟化的相关组件 | 依靠图形化界面安装部署 |
| 存储节点 | 存储节点用于部署分布式存储的相关组件 | 依靠图形化界面安装部署 |
| 网络节点 | 网络节点用于部署Neutron等网络的相关组件 | 依靠图形化界面安装部署 |

### 9.4.2 操作步骤 {#9-4-2}

点击左侧菜单栏的“管理->节点部署管理”，进入节点部署页面，该页面包含了两部分：部署服务器和节点列表。

在部署服务部分

1. 将部署服务器由“Down”状态设置为“Active”状态。
2. 添加裸机节点。点击列表右上角的“添加节点”按钮，在弹出框中填写节点名称、IPMI接口信息以及管理IP等信息。完毕后，点击“确认”提交。
3. 安装系统。点击具体节点右侧的“安装OS”功能链接，为物理节点安装系统。
4. 配置网络。点击具体节点右侧的“配置网络”功能链接，可在弹出框中执行发现网卡、编辑网卡信息和配置bond的操作。当已为节点指定角色并完成部署后，“配置网络”功能将禁用不可点击。
5. 指定节点角色。在节点列表中选定指定的节点，点击“部署节点”。在弹出框中勾选节点类型，同时填写节点的网卡信息以及存储网络信息。

### 9.4.3 其他操作 {#9-4-3}

| 操作 | 前提条件 | 描述 |
| :--- | | :--- | | :--- |
| 关机 | 物理节点处于开机状态 | 关闭物理节点 | 
| 开机 | 物理节点处于关机状态 | 开启物理机节点 |
| 重启 | -- | 重新启动物理节点 |
| 重装系统 | 仅“已安装OS”状态下的物理节点可执行重装系统操作 | 只有当物理节点已安装OS，但尚未部署角色时才可重装物理节点的系统 |
| 删除 | 仅“未安装OS”和“已安装OS”两种状态下的物理节点可执行删除操作 | 删除物理节点 |
| 卸载计算节点 | 为物理节点部署了计算节点角色 | 卸载节点上已经部署好的计算虚拟化相关组件 |
| 卸载网络节点 | 为物理节点部署了网络节点角色 | 卸载节点上已经部署好的网络相关组件 |

### 9.4.4 节点详情 {#9-4-4}

在节点列表中点击节点名称可进入节点详情页，查看节点的详细配置信息：

1. 基本信息：该部分信息适用于所有角色的物理节点，列出了物理节点的基本配置信息，包括名称、状态、 IP地址等，以及网卡列表和Bond列表。
2. 计算资源：该部分信息适用于部署了计算节点角色的物理节点，列出了计算资源的使用情况，以及物理节点上的云主机信息，管理员还可在这里执行云主机迁移操作。
3. 网络资源：该部分信息适用于部署了网络节点角色的物理节点，列出了物理节点上的网络资源信息，包括网络、路由器、负载均衡等。
4. 监控：该部分信息适用于所有角色的物理节点，展示了物理节点的监控信息，包括性能监控、服务监控和报警规则。

## 9.5 计算节点管理 {#9-5}

管理员可通过“计算节点管理”查看所有的物理机资源，包括预上线资源池和已上线资源池中的计算节点，以及这些计算节点当前的状态和使用情况。管理员可以创建新的资源池，向资源池中添加计算节点。 

### 9.5.1 资源池列表 {#9-5-1}

资源池列表展示了当前已有资源池的相关信息，包括资源池名称、所属网络分区、资源池中物理机的数量、静态调试策略、CPU复用比、RAM复用比、创建时间。

预上线资源池永远位于资源池列表中的第一列。

### 9.5.2 创建资源池 {#9-5-2}

点击页面右上方“添加资源池”按钮，在弹窗中填写资源池的名字、静态调度策略、CPU复用比以及RAM复用比，添加网络区域，之后点击“确定”完成创建。成功后可在资源池列表中查看到。

![](/assets/创建资源池.png)

CPU复用比：是指物理核与虚拟核的资源复用比例。数值越大代表单核物理CPU可虚拟出的虚拟CPU越多。
RAM复用比：是指物理内存与虚拟内存的资源复用比例。数值越大代表单位物理内存可虚拟出的虚拟内存越多。

### 9.5.3 资源池相关操作 {#9-5-3}

| 操作 | 前提条件 | 描述 |
| :--- | | :--- | | :--- |
| 查看物理机 | 资源池内已存在计算节点 | 点击“查看物理机”后，页面将自动跳转至计算节点列表部分，且自动筛选出指定资源池内的计算节点 | 
| 编辑 | -- | 可更新资源池名称、静态调度策略、CPU复用比、RAM复用比和网络分区 |
| 删除 | 资源池内无计算资源 | -- |

### 9.5.4 计算节点列表 {#9-5-4}

计算节点列表展示了当前所有的计算节点，包括计算节点的IP地址、主机名、电源状态、云主机数、CPU使用情况，以及内存使用情况。点击计算节点的IP地址可进入详情页，查看该计算节点的详细配置信息。

此外，可根据计算节点的IP地址进行精确搜索，也可按照所属资源池来对计算节点进行筛选。

### 9.5.5 计算节点相关操作 {#9-5-5}

| 操作 | 前提条件 | 描述 |
| :--- | | :--- | | :--- |
| 上电 | 计算节点电源状态为OFF | 上电计算节点 | 
| 下电 | 计算节点电源状态为ON | 下电计算节点 |
| 重启 | -- | 重新启动计算节点 |
| 上线 | 适用于位于预上线资源池中的计算节点 | 点击上线后，在弹出的窗口中选择资源池名称，将计算节点添加至指定资源池 |
| 下线 | 适用于已上线的计算节点 | 下线后，计算节点将重新分配到预上线资源池中 |

### 9.5.6 批量迁移虚拟机 {#9-5-6}

1. 在计算节点列表中点击某个计算节点的IP地址，可进入该计算节点的详情页，点击“计算资源”选项卡，查看虚拟机列表。
2. 通过切换右上角的“项目”列表来查看指定项目分布在这台计算节点的虚拟机。
3. 点选复选框选定虚拟机，点击“迁移云主机”。
4. 指定迁移的方式，完成迁移。
   * 自动迁移：云主机将被随机迁移到其他物理主机上。
   * 自定义迁移：云主机将被迁移到用户指定的物理主机上。

用户可根据实际情况选择”自动迁移“和”自定义迁移“，最后点击”确定“按钮即完成迁移操作。

![](/assets/计算节点管理-迁移主机.png)

### 9.5.7 虚拟机静态调度策略 {#9-5-7}

静态调度策略是指控制云主机在物理主机上如何分布的策略。

1. 进入“计算节点管理”页面，点击“静态调度策略”链接，进入静态调度策略管理页面。可以查看当前配置的调度策略信息。

2. 点击“添加调度策略”按钮，填写名称、描述、CPU权重和RAM权重。其中CPU和RAM的权重取值范围都为-100～100。数值为正的时候，单位物理资源上的云主机趋向于密集分布，且数值越大分布越密集。负值则相反。

![](/assets/创建智能调度策略.png)


## 9.6 网络分区管理 {#9-6}


### 9.6.1 背景知识 {#9-6-1}

网络分区是指将云的网络按一定区域进行划分和管理。不同的区域与不同的网络节点绑定。在租户指定虚拟网络要创建在哪个区域上后，对应网络资源实例则会下发到与此区域绑定的网络节点上。

### 9.6.2 创建分区 {#9-6-2}

1. 点击左侧“管理”打开菜单，选择“网络分区管理”。
2. 点击屏幕右上角的“创建分区”，在弹出对话框中填写名称以及描述信息，点击“确定”提交配置。
3. 在建立好的分区列表上选择“管理网络节点”，在弹出对话框中添加网络节点，将分区与指定的网络节点进行绑定。

### 9.6.3 更多操作 {#9-6-3}

| 操作 | 对应按钮 | 描述 |
| :--- | | :--- | | :--- |
| 编辑分区 | ![](/assets/icon-edit.png) | 修改网络分区的名称、描述信息 | 
| 删除分区 | ![](/assets/icon-delete.png) | 删除已创建分区 |

## 9.7 网络服务管理 {#9-7}

### 9.7.1 网络服务列表 {#9-7-1}

点击左侧“管理”打开菜单，选择“网络服务管理”，即可看到网络服务列表，列表提供了如下信息：网络服务的ID、类型、所在物理机、服务状态、所属网络区域，以及最近心跳时间。

可通过输入网络服务的UUID进行精确搜索，也可按照网络服务的类型、所在物理机以及所属网络区域快速筛选网络服务。

### 9.7.2 网络服务详情 {#9-7-2}

在网络服务列表中点击网络服务的UUID，即可进入网络详情页，查看更多详细信息。

网络服务详情展示了网络服务的基本信息和资源配置：

* 基本信息包括UUID、类型、所在物理机、服务状态，以及最近心跳时间。
* 资源配置包括网络区域、虚拟端口数量、网络映射关系、本地应答代理，以及本地tunnel IP。

## 9.8 虚拟网络管理 {#9-8}

虚拟网络结构主要展示一些基础虚拟网络资源配置，并开放一部分自定义配置。通过虚拟网络管理页面，

## 9.9 物理节点管理 {#9-9}

物理节点管理是针对物理机服务的资源配置和管理。包括添加资源池和创建物理机节点。

### 9.9.1 物理机资源池列表 {#9-9-1}

点击左侧菜单栏中的“管理”，选择“物理节点管理”，进入页面后便可看到资源池列表。

资源池列表展示了当前已有资源池的相关信息，包括资源池名称、所属网络分区、资源池中物理机的数量、创建时间。

预上线资源池永远位于资源池列表中的第一列。

### 9.9.2 创建物理机资源池 {#9-9-2}

点击列表右上角的“创建资源池”按钮，输入资源池名称，选择网络分区（如果物理机要与云主机互通，则选择云主机所在的网络分区）。

![](/assets/物理节点-创建资源池.png)

### 9.9.3 物理机列表 {#9-9-3}

物理机列表展示了当前所有的物理机，包括物理机名称、电源状态、状态、所属资源池、CPU、内存、硬盘以及创建时间。点击物理机名称可进入详情页，查看该物理机的详细配置信息。

### 9.9.4 创建物理机 {#9-9-4}

在物理机列表部分，点击“创建物理机”按钮，在弹窗中输入相关的参数，点击确认提交。

![](/assets/创建物理机-无网络类型.png)

### 9.9.5 物理机相关操作 {#9-5-5}

| 操作 | 前提条件 | 描述 |
| :--- | | :--- | | :--- |
| 开机 | 物理节点电源状态为OFF | 开启物理机 | 
| 关机 | 物理节点电源状态为ON | 关闭物理机 |
| 重启 | -- | 重新启动物理机 |
| 编辑 | 适用于可用状态的物理机 | 编辑物理机的相关参数 |
| 删除 | 适用于可用状态的物理机 | 正在使用状态的物理机不可删除 |
| 验证 | 适用于可用状态的物理机 | 验证物理机是否符合部署条件 |

![](/assets/验证信息-正确.png)

### 9.9.6 物理机详情 {#9-5-6}

在物理机列表中点击物理机名称可打开物理机详情页，查看详细配置信息。

物理机详情展示了物理机的基本信息和网络信息：

* 基本信息包括物理机名称、UUID、所属资源池、电源状态、ipmi地址、ipmi端口、部署状态、部署镜像、CPU、内存、硬盘容量、CPU架构，以及创建时间。
* 网络信息列出了当前物理机已配置的网卡，如果物理机尚未部署，则可添加或删除网卡。

## 9.10 监控服务器管理 {#9-10}

### 9.10.1 根监控服务器 {#9-10-1}

待补充

### 9.10.2 子监控服务器 {#9-10-2}

待补充

## 9.11 产品管理 {#9-11}

产品管理是对产品的定义，包括产品列表和资费模板。

### 9.11.1 产品列表 {#9-11-1}

1. 以admin或者maintenanceadmin账户登录控制台，建议采用后者。
2. 点击左侧菜单栏的“管理->产品管理”，进入产品管理页面，页面默认展示“产品列表”选项卡的内容。 

#### 9.11.1.1 创建产品 {#9-11-1-1}

点击产品列表页面右上方“创建产品”按钮，在弹出框中输入产品名称、产品描述，选择产品类型、资费模板，勾选“开放售卖”，最后点击“确定”按钮创建产品。

| 字段 | 描述 |
| :--- | | :--- |
| 产品名称 | 产品的名字 |
| 产品描述（可选）| 对产品的描述 |
| 产品类型 | 选择产品类型，包括云主机、磁盘、负载均衡、浮动IP、防火墙。</br> 不同产品类型的创建过程略有不同，例如，如果产品类型选择了“云主机”，则还需要设置CPU和内存配置。|
| 资费模板 | 选定“产品类型”后，“资费模板”会匹配出相应产品可选的资费模板。 |
| 开放售卖 | 勾选“开放售卖”后，产品状态变为“开放售卖”，此时不可对产品做编辑和删除操作，除非点击右侧“下架”使产品状态变为“暂停售卖”。 |

* 默认情况下：

 ![](/assets/创建产品-默认弹窗.png)

* 指定产品类型为云主机：

![](/assets/创建产品-云主机.png)

#### 9.11.1.2 相关操作 {#9-11-1-2}

产品列表每个产品右侧有相对应的操作按钮，包括编辑、删除、上架/下架。

| 操作 | 对应按钮 | 前提条件 | 描述 |
| :--- | | :--- | | :--- | | :--- |
| 编辑产品 | ![](/assets/icon-edit.png) | 产品状态为“暂停售卖” | 可更改产品名称、产品描述、资费模板及是否开放售卖 |
| 删除产品 | ![](/assets/icon-delete.png) | 产品状态为“暂停售卖” | 删除产品 |
| 上架 | ![](/assets/icon-onshelf.png) | 产品状态为“暂停售卖” | 点击上架后，产品状态由“暂停售卖”更改为“开放售卖” |
| 下架 | ![](/assets/icon-offshelf.png) | 产品状态为“开放售卖” | 点击下架后，产品状态由“开放售卖”更改为“暂停售卖” |

### 9.11.2 资费模板 {#9-11-2}

1. 以admin或者maintenanceadmin账户登录控制台，建议采用后者。
2. 点击左侧菜单栏的“管理->产品管理”，进入产品管理页面，选中“资费模板”选项卡，即可看到“资费模板”列表。 

#### 9.11.2.1 创建资费模板 {#9-11-2-1}

选择页面右上方“创建资费模板”按钮，在弹出框中输入资费名称、资费描述，选择产品类型、计费模式，选定“阶梯计费”方式，最后点击“确定”按钮创建资费模板。

| 字段 | 描述 |
| :--- | | :--- |
| 资费名称 |  资费模板的名字 |
| 资费描述（可选）| 对资费模板的描述 |
| 产品类型 | 选择产品类型，包括云主机、磁盘、负载均衡、浮动IP、防火墙。</br>不同产品类型的阶梯计费方式略有不同。 |
| 计费模式 | 计费模式分为包月和包年。 |
| 阶梯计费 | 可按不同的资费段进行阶梯计费。阶梯区间应保持连续。 |

![](/assets/创建资费模板.png)

#### 9.11.2.2 相关操作 {#9-11-2-2}

资费模板列表每个模板右侧有相对应的操作按钮，包括编辑、删除、复制。

| 操作 | 对应按钮 | 前提条件 | 描述 |
| :--- | | :--- | | :--- | | :--- |
| 编辑 | ![](/assets/icon-edit.png) | 资费模板还未关联产品 | 除产品类型外，其他设置均可更改。 |
| 删除 | ![](/assets/icon-delete.png) | 资费模板还未关联产品 | 删除资费模板。 |
| 复制 | ![](/assets/icon-copy.png) | -- | 复制资费模板，资费名称不可与已存在的模板重复。 |

#### 9.11.2.3 资费模板详情 {#9-11-2-3}

在资费模板列表中点击模板名称，即可进入资费模板详情页，查看更多详细信息。

资费模板详情展示了资费模板的基本信息和计费规则：

* 基本信息包括资费名称、资费描述、计费模式、产品类型，以及与该模板关联的产品。
* 计费规则部分列出详细的分段计费标准。

## 9.12 审批模板 {#9-12}

金山私有云平台提供审批功能，方便管理员更好地控制和了解资源的使用。审批功能主要包括审批模板和审批两大功能。可选的审批操作包括：创建/更新虚拟机，创建/扩展卷，关联floatingip，更新floatingip带宽。

* 审批模板模块主要用来制定审批人、审批流程，以及绑定审批操作。只有admin和service_admin可以进行审批模板的管理。

  其中，审批人必须为某个特定项目下的租户管理员owner用户。每个审批人登录云平台后能看到需要自己审批的请求，点击某一请求进入详细页面可以进行通过或拒绝操作。当其中任何一个审批人执行了拒绝操作，该审批直接拒绝，后续审批人不需要进行任何处理。

* 审批模块分审批人用户和非审批人用户两种情况。

  审批人用户登录云平台后，在左侧导航栏点击“审批”可以看到需要审批的审批列表以及自己的申请列表，在审批列表里点击指定的标题名字进入申请的详细页面，然后点击”通过”或“拒绝“操作按钮对申请进行审批。注意：当所有审批人全部审批通过以后，系统自动处理用户的请求；当其中任何一个审批人执行了拒绝操作，则该审批直接拒绝，后续审批人不需要进行任何处理。

  非审批人用户登录云平台后，在左侧导航栏点击“审批”可以看到自己的申请列表，对于审批失败的申请，可以点击“重新申请”，生成新的申请，等待审批。

### 9.12.1 创建审批模板 {#9-12-1}

1. 以admin或者maintenanceadmin账户登录控制台，建议采用后者。
2. 点击左侧菜单栏的“管理”菜单，在下拉菜单中点击“审批模板"，进入“审批模板”页面。
3. 点击页面右上方“添加模板”按钮，在弹窗中填写模板名称、审批时限、审批人，点击“确定”按钮完成审批模板的创建。

| 字段 | 描述 |
| :--- | | :--- |
| 模板名称 | 审批模板的名字 |
| 审批时限 | 范围为1~n天，审批只在审批时限内有效，失效后可以重新申请对资费模板的描述。 |
| 审批人 | 审批人至少有一个，且必须为某个项目下的租户管理员owner用户。 |
| 添加审批人 | 审批人的添加顺序即为审批流程的顺序，后添加的审批人需等待先添加的审批人审批通过以后才能执行审批操作。</br>注意：当其中任何一个审批人执行了拒绝操作，则该审批直接拒绝，后续审批人不需要进行任何处理。 | 

![](/assets/创建审批模板-1个.png)

### 9.12.2 绑定操作 {#9-12-2}

审批模板创建完成以后，点击右侧相应的“绑定操作”按钮，在弹出框中选择要被审批的项目，并勾选审批操作。可选的审批操作包括：创建/更新虚拟机，创建/扩展卷，关联floatingip，更新floatingip带宽。 

![](/assets/绑定操作-填充1.png)

### 9.12.3 其他操作 {#9-12-3}

Admin或maintenanceadmin用户创建审批模板后，还可以“修改审批模板”、“删除审批模板”、“添加审批人”、“绑定操作”。

点击指定的审批模板名称进入模板的详细页面，详细信息包括模板的”基本信息“、”审批人“、”已绑定操作“。为方便理解，这里选上一步新建的模板“test”。

![](/assets/审批模板详情.png)

| 操作 | 对应按钮 | 前提条件 | 描述 |
| :--- | | :--- | | :--- | | :--- |
| 修改审批模板 | 修改审批模板 | -- | 可修改审批模板名称和审批时限。 |
| 删除审批模板 | 删除审批模板 | 模板没有绑定审批操作 | 删除审批模板。 |
| 添加审批人 | 添加审批人 | -- | 点击审批人右侧的“添加审批人”按钮，可增添新的审批人以及调整审批人的顺序，重新制定当前审批模板的审批流程。</br> 其中，新增的审批人可以是同一项目下别的租户管理员owner或是其他项目下的租户管理员owner。|
| 编辑审批人 | ![](/assets/icon-edit.png) | -- | 点击审批人右方的编辑按钮，可对已有的审批人进行更改。</br>可更改为同一项目下别的租户管理员owner或是其他项目下的租户管理员owner。 |
| 删除审批人 | ![](/assets/icon-delete.png) | 现有审批人个数>=2 | 点击审批人下方的删除按钮，可删除现有审批人。 |
| 绑定操作 | 绑定操作 | -- | 点击已绑定操作右侧的“绑定操作”按钮，可增添一到多个新的项目下的操作到审批模板。</br>可选的审批操作包括：创建/更新虚拟机，创建/扩展卷，关联floatingip，更新floatingip带宽。 |
| 修改绑定操作 | ![](/assets/icon-edit.png) | -- | 点击已绑定操作部分右侧的修改按钮，可更改已绑定项目下的审批操作。 |

下图为审批模板test的详细页面的”添加审批人”操作框:

添加新的审批人后可点击右下角的上下箭头可调整审批人顺序，重新制定模板的审批流程。

![](/assets/添加审批人-默认.png)

### 9.12.4 审批流程示例 {#9-12-4}

为方便理解，首先假设如9.12.1所示创建了审批模板test，模板test的审批人为项目test下的租户管理员testowner。然后为模板test绑定项目admin下的“创建云主机”操作。

1. 以admin或者maintenanceadmin账户登录控制台，建议采用后者。
2. 点击左侧导航条中的“云主机 -> 云主机管理“，在右上角选择项目“admin”，然后点击“创建云主机”按钮，按照向导进行云主机的创建。
3. 最后点击“创建”按钮后，云主机并没有立即创建，而是右上角弹出“申请已经提交，请等待审批”的弹框。
![](/assets/等待审批.png)

4. 点击左侧导航栏的“审批”按钮，可看到admin的申请列表。
 ![](/assets/申请人admin的申请列表.png)

5. 退出云平台，以test-owner的身份重新登录。点击左侧导航栏的“审批”按钮，可看到审批列表。

 ![](/assets/审批人的审批列表.png)

6. “通过”或“拒绝”申请：点击审批列表指定的标题名字会进入申请的详细页面，包括该条申请的”基本信息“、”审批记录“。可点击”通过”或“拒绝“操作按钮对申请进行审批。为方便理解，这里点击标题创建云主机“test-vm”，进入详细页面。

 ![](/assets/审批详情.png)

 * 审批通过：勾选页面下方的“通过”操作，点击提交后，admin项目下会创建云主机“test-vm”。退出云平台，以admin的身份重新登录。点击左侧导航栏的“云主机->云主机管理”按钮，可看到云主机“test-vm”在创建中。
![](/assets/审批通过，创建成功.png)

 * 审批拒绝：勾选页面下方的“拒绝”操作，点击提交后，admin项目下并没有创建云主机“test-vm”。
退出云平台，以admin的身份重新登录。点击左侧导航栏的“云主机->云主机管理”按钮，可看到页面并没有云主机“test-vm”创建。
然后，点击左侧导航栏的“审批”按钮，可看到申请列表里“创建云主机test-vm”的申请状态为拒绝，如果需要可点击右侧“重新申请”按钮，重新生成同样的申请，等待审批人审批。
![](/assets/申请人的申请列表-拒绝后.png)
 点击“重新申请”后，申请标题一样，之前的申请状态变为“已重新申请”，新的申请状态为“待审批”。 
![](/assets/申请人重新申请后的列表.png)

## 9.13 PCI白名单管理 {#9-13}

PCI设备由几百个核组成，因此可以并发处理数千个线程。它们更多地用于计算消耗性操 作，比如视频处理和物理仿真等。鉴于现在图像和视频处理的应用越来越多,云计算对这方面的需求也越来越提上日程。PCI白名单功能实现了通过KVM透传PCI，使得PCI可以被一个VM独占，达到利用PCI的目的。

### 9.13.1 PCI白名单列表 {#9-13-1}

1. 以admin或者maintenanceadmin账户登录控制台，建议采用后者。
2. 点击左侧导航条中的“管理 -> PCI白名单管理“，进入PCI白名单管理页面。在此可查看名称、产品编号、厂商编码、产品类型及PCI设备数量。

### 9.13.2 创建PCI白名单 {#9-13-2}

点击列表右上方的“创建PCI白名单”按钮，在弹窗中输入名称、描述、产品类型、厂商编号、产品编码，点击“创建”按钮创建白名单。

![](/assets/弹窗-创建GPU类型.png)

* 厂商编号为4位，每一位的范围为0-9、a-f，例如10af。
* 产品编码为4位，每一位的范围为0-9、a-f，例如10af。

### 9.13.3 PCI白名单相关操作 {#9-13-3}

| 操作 | 对应按钮 | 描述 |
| :--- | | :--- | | :--- |
| 编辑 | ![](/assets/icon-edit.png) | 可修改白名单的名称和描述。 |
| 删除 | ![](/assets/icon-delete.png) | 删除PCI白名单。 |

### 9.13.4 PCI白名单详情 {#9-13-4}

在列表中点击白名单名称，即可进入详情页，查看更多详细信息。

PCI白名单详情展示了白名单的基本信息和PCI设备列表：

* 基本信息包括名称、UUID、产品编号、厂商编码，产品类型及PCI设备数量。
* PCI设备列表部分列出详细的PCI设备信息，包括设备ID、状态、所在物理机、绑定虚机、创建时间。

## 9.14 自动恢复管理 {#9-14}















































